CREATE DATABASE STAART;

USE STAART;

CREATE SCHEMA STREAM;


CREATE TABLE MANTIMENTO(
NOME VARCHAR(200),
DATA_DE_VENCIMENTO DATE
);


CREATE TABLE STREAM.ELETRONICOS(
NOME VARCHAR(200),
DESCRICAO VARCHAR(200)
);















CREATE TABLE STREAM.USERS(
ID_USER INT PRIMARY KEY,
NAME VARCHAR(255),
USERNAME VARCHAR(255),
PASSWORD VARCHAR(100),
CREATED_AT DATETIME
);

CREATE TABLE STREAM.CATEGORIES(
ID_CATEGORY INT AUTO_INCREMENT PRIMARY KEY,
NAME VARCHAR(255) UNIQUE NOT NULL
);



INSERT INTO STREAM.CATEGORIES(NAME) VALUES('DESENHO');




SELECT ID_CATEGORY
FROM STREAM.CATEGORIES
WHERE ID_CATEGORY > 1
;




INSERT INTO STREAM.USERS
(ID_USER, NAME, USERNAME, PASSWORD, CREATED_AT)
VALUES(2, 'THAISSA', 'THAI', '1234', CURRENT_DATE());




SELECT *
FROM STREAM.USERS;


UPDATE STREAM.USERS
SET PASSWORD = '5678' 
WHERE ID_USER = 1;



DELETE 
FROM STREAM.CATEGORIES
WHERE ID_CATEGORY = 3
;


ALTER TABLE STREAM.USERS
ADD CONSTRAINT NAME_UNIQUE UNIQUE(USERNAME);

 






INSERT INTO STREAM.CATEGORIES(NAME) VALUES('DRAMA');

SELECT * FROM STREAM.CATEGORIES;


-- IN
SELECT * FROM STREAM.CATEGORIES
WHERE ID_CATEGORY IN(1,4,6);


-- BETWEEN
SELECT * FROM STREAM.CATEGORIES
WHERE ID_CATEGORY BETWEEN 3 AND 6;


-- != <>
SELECT * FROM STREAM.CATEGORIES
WHERE ID_CATEGORY != 6;


SELECT * FROM STREAM.CATEGORIES
WHERE ID_CATEGORY = 6;

INSERT INTO STREAM.USERS
(ID_USER, NAME, USERNAME, PASSWORD, CREATED_AT)
VALUES(6, 'DANIEL', 'DANIEL', NULL, CURRENT_DATE());

-- IS NULL / -- IS NOT NULL
SELECT * FROM STREAM.USERS
WHERE PASSWORD IS NULL;



SELECT * FROM STREAM.USERS
WHERE PASSWORD IS NOT NULL;


-- LIKE
SELECT * FROM STREAM.USERS
WHERE NAME LIKE 'DANI%'



-- > < 

SELECT * FROM STREAM.USERS
WHERE ID_USER >= 2;

CREATE TABLE STREAM.PROFILE(
ID_PROFILE INT auto_increment PRIMARY KEY,
ID_USER_PROFILE INT,
BIO VARCHAR(300) DEFAULT 'MINHA BIO',
AVATAR_URL VARCHAR(200),
FOREIGN KEY(ID_USER_PROFILE) REFERENCES STREAM.USERS(ID_USER)
);

SELECT * FROM STREAM.PROFILE;

INSERT INTO STREAM.PROFILE(ID_USER_PROFILE, AVATAR_URL) VALUES(2, 'http://google.com.br/avatar_dani');

delete from stream.profile where id_profile > 1;


ALTER TABLE STREAM.PROFILE DROP FOREIGN KEY profile_ibfk_1;

ALTER TABLE STREAM.PROFILE
ADD CONSTRAINT FOREIGN KEY(ID_USER_PROFILE) REFERENCES STREAM.USERS(ID_USER),
ADD CONSTRAINT UNIQUE(ID_USER_PROFILE);


CREATE TABLE STREAM.CONTENT(
ID_CONTENT INT AUTO_INCREMENT PRIMARY KEY,
NAME VARCHAR(300),
ID_CATEGORY INT,
DURATION TIME,
FOREIGN KEY(ID_CATEGORY) REFERENCES STREAM.CATEGORIES (ID_CATEGORY)
);

SELECT * FROM STREAM.CATEGORIES;

INSERT INTO STREAM.CONTENT(NAME, ID_CATEGORY, DURATION)
VALUES('O REI LEAO', 5, '02:00');

SELECT * FROM STREAM.CONTENT;

CREATE TABLE STREAM.USERS_CONTENTS(
ID INT auto_increment primary KEY,
ID_USERS INT,
ID_CONTENT INT,
TIME_STOPPED TIME,
NOTE INT,
FOREIGN KEY(ID_USERS) REFERENCES STREAM.USERS(ID_USER),
FOREIGN KEY(ID_CONTENT) REFERENCES STREAM.CONTENT(ID_CONTENT)
);
 
 
 
 SELECT * FROM STREAM.CONTENT;
 


INSERT INTO STREAM.USERS_CONTENTS(ID_USERS, ID_CONTENT, TIME_STOPPED, NOTE)
VALUES(6, 2, '00:50', 10);
 
 INSERT INTO STREAM.USERS_CONTENTS(ID_USERS, ID_CONTENT, TIME_STOPPED, NOTE)
VALUES(6, 1, '00:34', 8);

INSERT INTO STREAM.USERS_CONTENTS(ID_USERS, ID_CONTENT, TIME_STOPPED, NOTE)
VALUES(1, 1, '01:20', 8);

SELECT * FROM STREAM.USERS_CONTENTS;

SELECT * FROM STREAM.USERS_CONTENTS
INNER JOIN STREAM.USERS
ON STREAM.USERS_CONTENTS.ID_USERS = STREAM.USERS.ID_USERS;
 
